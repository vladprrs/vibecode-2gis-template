# –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ü–µ–Ω–∞—Ä–∏—è "–ü–æ–∏—Å–∫ –∏ –Ω–∞–≤–∏–≥–∞—Ü–∏—è"

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π –æ–±–∑–æ—Ä

–ü—Ä–æ–µ–∫—Ç —É–∂–µ –∏–º–µ–µ—Ç —á–µ—Ç–∫–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É —Å —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –Ω–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã, —Å–µ—Ä–≤–∏—Å—ã –∏ —Ç–∏–ø—ã. –≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ–ª–Ω–æ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è –ø–æ–∏—Å–∫–∞ –∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏.

## –°—É—â–µ—Å—Ç–≤—É—é—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

```
src/
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îú‚îÄ‚îÄ Bottomsheet/           # –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —à—Ç–æ—Ä–∫–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ BottomsheetContainer.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ BottomsheetHeader.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ BottomsheetContent.ts
‚îÇ   ‚îú‚îÄ‚îÄ Cards/                 # –ö–∞—Ä—Ç–æ—á–∫–∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ OrganizationCard.ts
‚îÇ   ‚îú‚îÄ‚îÄ Dashboard/             # –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–∞—à–±–æ—Ä–¥–∞
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ DashboardComponents.ts
‚îÇ   ‚îú‚îÄ‚îÄ Screens/               # –≠–∫—Ä–∞–Ω—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ DashboardScreen.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ SuggestScreen.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ SearchResultScreen.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ OrganizationScreen.ts
‚îÇ   ‚îî‚îÄ‚îÄ Search/                # –ü–æ–∏—Å–∫–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ       ‚îú‚îÄ‚îÄ SearchBar.ts
‚îÇ       ‚îú‚îÄ‚îÄ SearchSuggestions.ts
‚îÇ       ‚îî‚îÄ‚îÄ SearchFilters.ts
‚îú‚îÄ‚îÄ services/                  # –£–ø—Ä–∞–≤–ª—è—é—â–∏–µ —Å–µ—Ä–≤–∏—Å—ã
‚îÇ   ‚îú‚îÄ‚îÄ SearchFlowManager.ts   # –ù–∞–≤–∏–≥–∞—Ü–∏—è –º–µ–∂–¥—É —ç–∫—Ä–∞–Ω–∞–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ BottomsheetManager.ts  # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏ —à—Ç–æ—Ä–∫–∏
‚îÇ   ‚îî‚îÄ‚îÄ MapSyncService.ts      # –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫–∞—Ä—Ç—ã –∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
‚îî‚îÄ‚îÄ types/                     # TypeScript –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
    ‚îú‚îÄ‚îÄ navigation.ts          # –¢–∏–ø—ã –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –∏ –ø–æ–∏—Å–∫–∞
    ‚îú‚îÄ‚îÄ bottomsheet.ts         # –¢–∏–ø—ã —à—Ç–æ—Ä–∫–∏
    ‚îî‚îÄ‚îÄ map.ts                 # –¢–∏–ø—ã –∫–∞—Ä—Ç—ã
```

---

## –û—Å–Ω–æ–≤–Ω—ã–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã

### 1. –ï–¥–∏–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π —à—Ç–æ—Ä–∫–∏

**–£–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ `src/types/bottomsheet.ts`:**

```typescript
export enum BottomsheetState {
  SMALL = 'small',                    // ~20% –≤—ã—Å–æ—Ç—ã —ç–∫—Ä–∞–Ω–∞
  DEFAULT = 'default',                // ~50% –≤—ã—Å–æ—Ç—ã —ç–∫—Ä–∞–Ω–∞  
  FULLSCREEN = 'fullscreen',          // ~90% –≤—ã—Å–æ—Ç—ã —ç–∫—Ä–∞–Ω–∞
  FULLSCREEN_SCROLL = 'fullscreen_scroll' // 95%+ —Å –ø—Ä–æ–∫—Ä—É—Ç–∫–æ–π
}

export interface BottomsheetConfig {
  state: BottomsheetState;
  snapPoints: number[];     // [0.2, 0.5, 0.9, 0.95]
  isDraggable: boolean;
  hasScrollableContent: boolean;
}
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ `src/services/BottomsheetManager.ts`:**

```typescript
export class BottomsheetManager {
  getCurrentState(): BottomsheetStateData
  snapToState(targetState: BottomsheetState): Promise<void>
  handleDragGesture(gestureState: GestureState): void
}
```

### 2. –ú–µ–Ω–µ–¥–∂–µ—Ä –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ –º–µ–∂–¥—É —ç–∫—Ä–∞–Ω–∞–º–∏

**–£–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ `src/services/SearchFlowManager.ts`:**

```typescript
export class SearchFlowManager {
  public currentScreen: ScreenType;
  public searchContext: SearchContext;
  public navigationHistory: ScreenType[];
  
  // –ú–µ—Ç–æ–¥—ã –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
  goToSuggest(): void
  goToSearchResults(query: string, filters?: SearchFilters): void
  goToOrganization(org: Organization): void
  goBack(): void
  
  // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–∏—Å–∫–æ–≤—ã–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
  updateQuery(query: string): void
  updateFilters(filters: SearchFilters): void
  addToHistory(query: string): void
}
```

### 3. –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫–∞—Ä—Ç—ã –∏ —à—Ç–æ—Ä–∫–∏

**–£–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ `src/services/MapSyncService.ts`:**

```typescript
export class MapSyncService {
  // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∏–Ω–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ —à—Ç–æ—Ä–∫–∏
  syncPinsWithContent(content: ContentType, options: SyncOptions): void
  
  // –í—ã–¥–µ–ª–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø–∏–Ω–∞ –ø—Ä–∏ –≤—ã–±–æ—Ä–µ –∫–∞—Ä—Ç–æ—á–∫–∏
  highlightOrganizationPin(orgId: string): void
  
  // –ê–¥–∞–ø—Ç–∞—Ü–∏—è –≤–∏–¥–∏–º–æ–π –æ–±–ª–∞—Å—Ç–∏ –∫–∞—Ä—Ç—ã –ø–æ–¥ –≤—ã—Å–æ—Ç—É —à—Ç–æ—Ä–∫–∏
  adjustMapViewport(bottomsheetHeight: number): void
}
```

---

## –ü–æ—Ç–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å—Ü–µ–Ω–∞—Ä–∏—è

### –≠–∫—Ä–∞–Ω 1: Dashboard

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç:** `src/components/Screens/DashboardScreen.ts`

```typescript
export class DashboardScreen {
  // –£–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
  private bottomsheetContainer: BottomsheetContainer
  private bottomsheetHeader: BottomsheetHeader
  private bottomsheetContent: BottomsheetContent
  private searchBar: SearchBar
  
  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ñ–æ–∫—É—Å–∞ –Ω–∞ –ø–æ–∏—Å–∫–æ–≤–æ–π —Å—Ç—Ä–æ–∫–µ
  private handleSearchFocus(): void {
    this.props.searchFlowManager.goToSuggest();
    this.props.onSearchFocus?.();
  }
}
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```typescript
const dashboardScreen = new DashboardScreen({
  container: document.getElementById('app'),
  searchFlowManager,
  bottomsheetManager,
  mapSyncService,
  onSearchFocus: () => console.log('Search activated')
});
```

### –≠–∫—Ä–∞–Ω 2: Suggest (–ü–æ–¥—Å–∫–∞–∑–∫–∏)

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç:** `src/components/Screens/SuggestScreen.ts`

```typescript
export class SuggestScreen {
  // –£–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
  private searchBar: SearchBar           // –ê–∫—Ç–∏–≤–Ω–∞—è –ø–æ–∏—Å–∫–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞
  private searchSuggestions: SearchSuggestions // –°–ø–∏—Å–æ–∫ –ø–æ–¥—Å–∫–∞–∑–æ–∫
  
  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—ã–±–æ—Ä–∞ –ø–æ–¥—Å–∫–∞–∑–∫–∏
  private handleSuggestionSelect(suggestion: SearchSuggestion): void {
    this.props.searchFlowManager.goToSearchResults(suggestion.text);
  }
  
  // –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–¥—Å–∫–∞–∑–æ–∫
  private async loadSuggestions(): Promise<void> {
    const suggestions = await this.props.searchFlowManager.getSuggestions();
    this.searchSuggestions?.updateSuggestions(suggestions);
  }
}
```

### –≠–∫—Ä–∞–Ω 3: Search Results (–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞)

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç:** `src/components/Screens/SearchResultScreen.ts`

```typescript
export class SearchResultScreen {
  // –£–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
  private searchBar: SearchBar           // –ü–æ–∏—Å–∫–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞ —Å –∑–∞–ø—Ä–æ—Å–æ–º
  private searchFilters: SearchFilters   // –ü–∞–Ω–µ–ª—å —Ñ–∏–ª—å—Ç—Ä–æ–≤
  private organizationCards: OrganizationCard[] // –°–ø–∏—Å–æ–∫ –∫–∞—Ä—Ç–æ—á–µ–∫
  
  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –ø–æ –∫–∞—Ä—Ç–æ—á–∫–µ
  private handleOrganizationClick(org: Organization): void {
    this.props.searchFlowManager.goToOrganization(org);
    this.props.mapSyncService?.highlightOrganizationPin(org.id);
  }
  
  // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Å –∫–∞—Ä—Ç–æ–π
  private syncResultsWithMap(): void {
    const results = this.props.searchFlowManager.searchContext.results;
    this.props.mapSyncService?.syncPinsWithContent('search_results', {
      organizations: results
    });
  }
}
```

### –≠–∫—Ä–∞–Ω 4: Organization (–ö–∞—Ä—Ç–æ—á–∫–∞ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏)

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç:** `src/components/Screens/OrganizationScreen.ts`

```typescript
export class OrganizationScreen {
  // –£–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
  private organizationHeader: OrganizationHeader
  private organizationTabs: OrganizationTabs
  private actionBar: ActionBar
  
  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ "–ù–∞–∑–∞–¥"
  private handleBackClick(): void {
    this.props.searchFlowManager.goBack();
  }
}
```

---

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

### 1. –ü–æ–∏—Å–∫–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

#### SearchBar (`src/components/Search/SearchBar.ts`)

```typescript
// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
const searchBar = new SearchBar(container, {
  placeholder: '–ü–æ–∏—Å–∫ –≤ –ú–æ—Å–∫–≤–µ',
  state: SearchBarState.ACTIVE,
  showSearchIcon: true,
  onFocus: () => searchFlowManager.goToSuggest(),
  onQueryChange: (query) => searchFlowManager.updateQuery(query)
});

// –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º
searchBar.setState(SearchBarState.ACTIVE);
searchBar.setValue('–∫–∞—Ñ–µ —Ä—è–¥–æ–º');
```

#### SearchSuggestions (`src/components/Search/SearchSuggestions.ts`)

```typescript
// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
const suggestions = new SearchSuggestions(container, {
  suggestions: [],
  showHistory: true,
  onSuggestionSelect: (suggestion) => {
    searchFlowManager.goToSearchResults(suggestion.text);
  }
});

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
suggestions.updateSuggestions(newSuggestions);
```

#### SearchFilters (`src/components/Search/SearchFilters.ts`)

```typescript
// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞–Ω–µ–ª–∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤
const filters = new SearchFilters(container, {
  filters: searchFlowManager.searchContext.filters,
  onFiltersChange: (newFilters) => {
    searchFlowManager.updateFilters(newFilters);
  }
});
```

### 2. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —à—Ç–æ—Ä–∫–∏

#### BottomsheetContainer (`src/components/Bottomsheet/BottomsheetContainer.ts`)

```typescript
// –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —à—Ç–æ—Ä–∫–∏
const bottomsheetConfig: BottomsheetContainerProps = {
  config: {
    state: BottomsheetState.DEFAULT,
    snapPoints: [0.2, 0.5, 0.9, 0.95],
    isDraggable: true,
    hasScrollableContent: true
  },
  events: {
    onStateChange: (newState) => {
      bottomsheetManager.snapToState(newState);
      mapSyncService.adjustMapViewport(getHeightForState(newState));
    }
  }
};

const bottomsheet = new BottomsheetContainer(element, bottomsheetConfig);
```

### 3. –ö–∞—Ä—Ç–æ—á–∫–∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π

#### OrganizationCard (`src/components/Cards/OrganizationCard.ts`)

```typescript
// –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏
const card = new OrganizationCard(container, {
  organization: {
    id: 'org_1',
    name: '–ö–∞—Ñ–µ "–ü—Ä–∏–º–µ—Ä"',
    address: '—É–ª. –¢–≤–µ—Ä—Å–∫–∞—è, 1',
    coordinates: [37.617734, 55.752023],
    isAdvertiser: false,
    rating: 4.5,
    reviewsCount: 123
  },
  size: CardSize.MEDIUM,
  onClick: (org) => searchFlowManager.goToOrganization(org)
});
```

---

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º

### 1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```typescript
// –°–æ–∑–¥–∞–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
const searchFlowManager = new SearchFlowManager(ScreenType.DASHBOARD, {
  onScreenChange: (screen) => console.log('Screen:', screen)
});

const bottomsheetManager = new BottomsheetManager({
  state: BottomsheetState.DEFAULT,
  snapPoints: [0.2, 0.5, 0.9, 0.95],
  isDraggable: true,
  hasScrollableContent: false
});

const mapSyncService = new MapSyncService(mapRef, {
  onPinHighlight: (orgId) => console.log('Pin highlighted:', orgId)
});

// –°–æ–∑–¥–∞–Ω–∏–µ —ç–∫—Ä–∞–Ω–æ–≤
const screens = {
  dashboard: new DashboardScreen({
    container: document.getElementById('dashboard'),
    searchFlowManager,
    bottomsheetManager,
    mapSyncService
  }),
  suggest: new SuggestScreen({
    container: document.getElementById('suggest'),
    searchFlowManager,
    bottomsheetManager
  }),
  searchResult: new SearchResultScreen({
    container: document.getElementById('search-results'),
    searchFlowManager,
    bottomsheetManager,
    mapSyncService
  }),
  organization: new OrganizationScreen({
    container: document.getElementById('organization'),
    searchFlowManager,
    bottomsheetManager,
    mapSyncService
  })
};
```

### 2. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ—Ö–æ–¥–∞–º–∏

```typescript
// –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —ç–∫—Ä–∞–Ω–∞
searchFlowManager.onScreenChange((screen: ScreenType) => {
  // –°–∫—Ä—ã—Ç—å –≤—Å–µ —ç–∫—Ä–∞–Ω—ã
  Object.values(screens).forEach(s => s.deactivate());
  
  // –ü–æ–∫–∞–∑–∞—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–π —ç–∫—Ä–∞–Ω
  switch(screen) {
    case ScreenType.DASHBOARD:
      screens.dashboard.activate();
      bottomsheetManager.snapToState(BottomsheetState.DEFAULT);
      break;
    case ScreenType.SUGGEST:
      screens.suggest.activate();
      bottomsheetManager.snapToState(BottomsheetState.FULLSCREEN);
      break;
    case ScreenType.SEARCH_RESULT:
      screens.searchResult.activate();
      bottomsheetManager.snapToState(BottomsheetState.FULLSCREEN_SCROLL);
      break;
    case ScreenType.ORGANIZATION:
      screens.organization.activate();
      bottomsheetManager.snapToState(BottomsheetState.FULLSCREEN_SCROLL);
      break;
  }
});
```

---

## –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏ –ª—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

### 1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ñ–∞–±—Ä–∏–∫

–í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏–º–µ—é—Ç —Ñ–∞–±—Ä–∏—á–Ω—ã–µ –º–µ—Ç–æ–¥—ã –¥–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è —Å–æ–∑–¥–∞–Ω–∏—è:

```typescript
// –í–º–µ—Å—Ç–æ new SearchBar(...)
const searchBar = SearchBarFactory.create({
  container,
  placeholder: '–ü–æ–∏—Å–∫ –≤ –ú–æ—Å–∫–≤–µ'
});

// –í–º–µ—Å—Ç–æ new OrganizationCard(...)
const card = OrganizationCardFactory.create({
  container,
  organization: orgData
});
```

### 2. –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

```typescript
// –û–¥–∏–Ω —ç–∫–∑–µ–º–ø–ª—è—Ä SearchBar –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —ç–∫—Ä–∞–Ω–∞—Ö
const sharedSearchBar = SearchBarFactory.create({
  container: document.getElementById('search-container'),
  onQueryChange: (query) => {
    // –û–±–Ω–æ–≤–ª—è–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç –≤–æ –≤—Å–µ—Ö —ç–∫—Ä–∞–Ω–∞—Ö
    searchFlowManager.updateQuery(query);
  }
});

// –ü–µ—Ä–µ–¥–∞–µ–º –≤ —Ä–∞–∑–Ω—ã–µ —ç–∫—Ä–∞–Ω—ã
const suggestScreen = new SuggestScreen({
  searchBar: sharedSearchBar, // –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º
  // ... –¥—Ä—É–≥–∏–µ –ø—Ä–æ–ø—Å—ã
});
```

### 3. –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

```typescript
// –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π SearchFlowManager –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
searchFlowManager.searchContext.suggestions; // –ö—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏
searchFlowManager.searchContext.results;     // –ö—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
searchFlowManager.searchContext.searchHistory; // –ò—Å—Ç–æ—Ä–∏—è –ø–æ–∏—Å–∫–∞
```

---

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 1. Unit —Ç–µ—Å—Ç—ã –¥–ª—è —Å–µ—Ä–≤–∏—Å–æ–≤

```typescript
describe('SearchFlowManager', () => {
  test('should navigate to suggest screen', () => {
    const manager = new SearchFlowManager();
    manager.goToSuggest();
    expect(manager.currentScreen).toBe(ScreenType.SUGGEST);
  });
});

describe('BottomsheetManager', () => {
  test('should snap to correct state', async () => {
    const manager = new BottomsheetManager({
      state: BottomsheetState.DEFAULT,
      snapPoints: [0.2, 0.5, 0.9, 0.95],
      isDraggable: true,
      hasScrollableContent: false
    });
    
    await manager.snapToState(BottomsheetState.FULLSCREEN);
    expect(manager.getCurrentState().currentState).toBe(BottomsheetState.FULLSCREEN);
  });
});
```

### 2. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã

```typescript
describe('Search Flow Integration', () => {
  test('should complete full search flow', async () => {
    const { searchFlowManager, screens } = setupTestEnvironment();
    
    // –ê–∫—Ç–∏–≤–∞—Ü–∏—è –ø–æ–∏—Å–∫–∞
    searchFlowManager.goToSuggest();
    expect(searchFlowManager.currentScreen).toBe(ScreenType.SUGGEST);
    
    // –ü–æ–∏—Å–∫
    searchFlowManager.goToSearchResults('–∫–∞—Ñ–µ');
    expect(searchFlowManager.currentScreen).toBe(ScreenType.SEARCH_RESULT);
    expect(searchFlowManager.searchContext.query).toBe('–∫–∞—Ñ–µ');
    
    // –ü–µ—Ä–µ—Ö–æ–¥ –∫ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
    const org = mockOrganization();
    searchFlowManager.goToOrganization(org);
    expect(searchFlowManager.currentScreen).toBe(ScreenType.ORGANIZATION);
    expect(searchFlowManager.searchContext.selectedOrganization).toBe(org);
  });
});
```

---

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞

### 1. –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –≤ —Å–µ—Ä–≤–∏—Å–∞—Ö

```typescript
// SearchFlowManager —É–∂–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è
const manager = new SearchFlowManager(ScreenType.DASHBOARD, {
  onScreenChange: (screen) => {
    analytics.track('screen_change', { screen });
  },
  onSearchPerformed: (query) => {
    analytics.track('search_performed', { query });
  }
});

// BottomsheetManager –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è
const bottomsheet = new BottomsheetManager(config, {
  onStateChange: (from, to) => {
    analytics.track('bottomsheet_state_change', { from, to });
  },
  onDragEnd: (finalState) => {
    analytics.track('bottomsheet_drag_interaction', { finalState });
  }
});
```

### 2. –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

```typescript
// –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –º–µ—Ç–æ–¥—ã –¥–ª—è –∏–∑–º–µ—Ä–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
const performanceManager = {
  measureSearchLatency: async (query: string) => {
    const start = performance.now();
    await searchFlowManager.performSearch(query);
    const duration = performance.now() - start;
    
    analytics.track('search_performance', { query, duration });
  }
};
```

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–°—É—â–µ—Å—Ç–≤—É—é—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ —É–∂–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–ª—è –ø–æ–ª–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Å—Ü–µ–Ω–∞—Ä–∏—è "–ü–æ–∏—Å–∫ –∏ –Ω–∞–≤–∏–≥–∞—Ü–∏—è":

### ‚úÖ –ß—Ç–æ —É–∂–µ –≥–æ—Ç–æ–≤–æ:
- **–í—Å–µ —ç–∫—Ä–∞—ã**: Dashboard, Suggest, SearchResult, Organization
- **–í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã**: SearchBar, SearchSuggestions, SearchFilters, OrganizationCard
- **–£–ø—Ä–∞–≤–ª—è—é—â–∏–µ —Å–µ—Ä–≤–∏—Å—ã**: SearchFlowManager, BottomsheetManager, MapSyncService
- **–¢–∏–ø–∏–∑–∞—Ü–∏—è**: –ü–æ–ª–Ω—ã–µ TypeScript –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã**: –§–∞–±—Ä–∏–∫–∏, —Å–æ–±—ã—Ç–∏—è, —Å–æ—Å—Ç–æ—è–Ω–∏–µ

### üîß –ß—Ç–æ –Ω—É–∂–Ω–æ –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:
1. **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤** —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
2. **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π** –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏
3. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ –º–µ–∂–¥—É —ç–∫—Ä–∞–Ω–∞–º–∏** —á–µ—Ä–µ–∑ SearchFlowManager
4. **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —à—Ç–æ—Ä–∫–∏** —á–µ—Ä–µ–∑ BottomsheetManager
5. **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å –∫–∞—Ä—Ç–æ–π** —á–µ—Ä–µ–∑ MapSyncService

### üöÄ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ç–µ–∫—É—â–µ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã:
- **–ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å**: –ö–∞–∂–¥—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º –∏ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º
- **–¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –ü–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ TypeScript
- **–¢–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å**: –ß–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
- **–†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å**: –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –õ–µ–Ω–∏–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

–î–∞–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –≥–æ—Ç–æ–≤–∞ –∫ production –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –∏ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç —Å–æ–∑–¥–∞–Ω–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ - —Ç–æ–ª—å–∫–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö. 