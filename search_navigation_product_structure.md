# Продуктовая структура: Пользовательский сценарий "Поиск и навигация"

## Общая архитектура сценария

**Принцип**: Единая архитектура шторки поверх карты — все этапы поиска происходят в адаптивной шторке, которая размещается поверх интерактивной карты.

**Пользовательский флоу**:
```
Dashboard (шторка) → Suggest (шторка) → Search Result (шторка) → Organization Card (шторка)
     ↓                    ↓                    ↓                        ↓
[поисковая строка]   [выбор подсказки]   [клик на карточку]    [детальная информация]
```

---

## 1. Экран "Dashboard" — Точка входа в поиск

### Назначение
Главный экран приложения, предоставляющий доступ к поиску и основному контенту.

### Состояния шторки
- **`state_small`** — минимальная высота шторки
  - Видна только поисковая строка и кнопки быстрого доступа
  - Максимальная видимость карты
  - **Триггер перехода**: клик на поисковую строку

- **`state_default`** — средняя высота (основное состояние)
  - Видны основные блоки контента
  - Баланс между картой и содержимым
  
- **`state_fullscreen`** — полная высота
  - Фокус на контенте в шторке
  - Минимальная видимость карты

- **`state_fullscreen_scroll`** — полная высота с прокруткой
  - Весь контент доступен через прокрутку внутри шторки

### Ключевые компоненты

#### Структурные элементы шторки:
- **`bottomsheet`** — основной контейнер всего контента
- **`bottomsheet_header`** — заголовок с поисковой строкой и драггером
  - Поисковая строка с плейсхолдером "Поиск в Москве"
  - Драггер для изменения высоты шторки

#### UI компоненты в шторке:
- **`button_row`** — горизонтальный ряд кнопок категорий
- **`button_row_on_map`** — кнопки, связанные с картой
- **`stories`** + **`story`** — блок историй с горизонтальной прокруткой
- **`cover`** / **`cover_big`** — карточки коллекций и гидов
- **`meta_item`** / **`meta_item_ad`** / **`meta_item_rubric`** — карточки категорий
- **`promo`** — промо-блоки
- **`banner`** — рекламные баннеры
- **`RD`** — блоки организаций-рекламодателей

### UX/UI особенности
- **Поисковая строка всегда доступна** в заголовке шторки
- **Фоновая карта интерактивна** — зуммирование и перетаскивание
- **Горизонтальные скроллы** внутри шторки для Stories и категорий
- **Адаптивная высота шторки** — изменяется жестами или автоматически

---

## 2. Экран "Suggest" — Подсказки поиска

### Назначение
Предоставление релевантных подсказок при активации поиска.

### Состояния шторки
- **`state_default`** — единственное состояние
  - Средняя высота шторки
  - Фокус на списке подсказок
  - **Триггер перехода**: выбор подсказки из списка

### Ключевые компоненты

#### Структурные элементы:
- **`bottomsheet`** — пример контейнера подсказок
- **`bottomsheet_header`** — заголовок с активной поисковой строкой
  - Поисковая строка в фокусе
  - Клавиатура открыта
  - Возможность ввода запроса

#### Содержимое шторки:
- **Список подсказок** различных типов:
  - История предыдущих поисков
  - Популярные запросы
  - Организации с автодополнением
  - Адреса и местоположения
  - Категории и рубрики

### UX/UI особенности
- **Активная поисковая строка** — пользователь может печатать
- **Динамические подсказки** — обновляются по мере ввода
- **Дополнительная информация** в подсказках: адреса, количество филиалов
- **Фоновая карта** может показывать релевантные пины

---

## 3. Экран "Search Result" — Результаты поиска

### Назначение
Отображение результатов поиска с возможностью фильтрации и детального просмотра.

### Состояния шторки
- **`state_default`** — средняя высота (основное состояние)
  - Список результатов с возможностью прокрутки
  - Видимость части карты с пинами результатов
  - **Триггер перехода**: клик на карточку организации

- **`state_fullscreen`** — полная высота
  - Максимальное количество результатов на экране
  - Минимальная видимость карты

- **`state_fullscreen_scroll`** — полная высота с прокруткой
  - Бесконечная прокрутка результатов внутри шторки

### Ключевые компоненты

#### Структурные элементы:
- **`bottomsheet_header`** — заголовок с поисковым запросом
- **`filters`** — панель фильтров в верхней части шторки
  - Горизонтальная прокрутка фильтров
  - Активные/неактивные состояния

#### Контент результатов:
- **`results`** / **`results_content`** — контейнеры списка результатов

#### Типы карточек организаций в шторке:
- **`card_advertiser`** — карточки рекламодателей
  - Расширенная информация
  - Дополнительные кнопки действий
  - Выделенное оформление

- **`card_advertiser_example`** — примеры карточек рекламодателей

- **`card_non_advertiser`** — обычные карточки организаций
  - Стандартная информация
  - Базовые кнопки действий

- **`card_not_advertiser_ZMK`** — специальные карточки для ЗМК
  - Интеграция с сервисами заказа

#### Дополнительные элементы:
- **`banner`** — рекламные баннеры между результатами
- **`ZMK_button`** — кнопки интеграции с ЗМК-сервисами

### UX/UI особенности
- **Синхронизация с картой** — выбранная карточка подсвечивается на карте
- **Фильтры в шторке** — быстрый доступ к настройкам поиска
- **Смешанный контент** — органические результаты + реклама
- **Бесконечная прокрутка** в fullscreen режиме

---

## 4. Экран "Organization Card" — Карточка организации

### Назначение
Детальная информация об организации с возможностями взаимодействия.

### Состояния шторки

#### Для рекламодателей:
- **`state_advertiser`** — стандартная высота рекламодателя
  - Расширенная информация
  - Дополнительные возможности
  
- **`state_advertiser_fullscreen`** — полноэкранная карточка рекламодателя
  - Полный набор функций и информации

#### Для обычных организаций:
- **`state_not_advertiser`** — стандартная карточка организации
  - Базовая информация
  - Стандартные функции

- **`state_not_advertiser_fullscreen`** — полноэкранная обычная карточка
  - Максимум доступной информации

### Ключевые компоненты

#### Заголовки шторки:
- **`header_advertiser`** — заголовок для рекламодателей
  - Логотип, название, статус рекламодателя
  - Расширенные метаданные

- **`header_not_advertiser`** — заголовок для обычных организаций
  - Название, базовая информация
  - Стандартные метаданные

#### Навигация и действия:
- **`tabbar`** — табы для переключения контента внутри шторки:
  - Обзор
  - Меню  
  - Фото
  - Отзывы
  - Информация
  - Акции

- **`actionbar`** / **`actionbar_full`** — панели действий в нижней части шторки
  - Быстрые действия: позвонить, проложить маршрут, сохранить
  - Кнопки социальных функций

#### Информационные блоки в шторке:
- **`about`** — информация о компании
- **`adress`** — адрес и местоположение  
- **`contacts`** — контактная информация
- **`worktime`** — часы работы
- **`menu`** — меню товаров/услуг
- **`feedback`** — отзывы клиентов
- **`friends`** — активность друзей
- **`branch`** — информация о филиалах
- **`discounts`** — акции и скидки
- **`info`** — дополнительная информация
- **`content`** — основное содержимое
- **`items_and_utilities`** — товары и услуги

#### Дополнительные элементы:
- **`alert`** — системные уведомления (временно закрыто, изменения в работе)

### UX/UI особенности
- **Синхронизация с картой** — пин организации выделен на фоне
- **Табы внутри шторки** — переключение контента без изменения высоты
- **Фотогалерея** — горизонтальная прокрутка изображений
- **Действия в нижней части** — быстрый доступ к основным функциям
- **Адаптивное содержимое** — разный набор информации для разных типов организаций

---

## Интеграционные элементы

### Карта (постоянный фоновый элемент)
- **Всегда видна** под шторкой
- **Интерактивна** на всех этапах флоу
- **Синхронизирована с контентом** шторки:
  - Dashboard: показывает пины популярных мест
  - Search Result: отображает пины найденных организаций
  - Organization Card: выделяет пин выбранной организации

### Поисковая строка (сквозной элемент)
- **Присутствует на всех этапах** в заголовке шторки
- **Состояния**:
  - Неактивная (Dashboard): плейсхолдер "Поиск в Москве"
  - Активная (Suggest): в фокусе с клавиатурой
  - Заполненная (Search Result, Organization): показывает текущий запрос

### Система управления шторкой
- **Драггер** — элемент для изменения высоты
- **Snap points** — автоматическое "прилипание" к определенным высотам
- **Gesture navigation** — свайпы для управления состояниями

---

## Технические требования к реализации

### Состояния и переходы
1. **Автоматические переходы**:
   - Клик на поисковую строку → переход к Suggest
   - Выбор подсказки → переход к Search Result
   - Клик на карточку → переход к Organization Card

2. **Ручное управление шторкой**:
   - Свайп вверх/вниз по драггеру
   - Snap points для фиксации на определенных высотах
   - Анимированные переходы между состояниями

### Синхронизация данных
- **Состояние поиска** должно передаваться между экранами
- **Выбранные фильтры** сохраняются при переходах
- **История взаимодействий** для улучшения подсказок

### Производительность
- **Ленивая загрузка** компонентов шторки
- **Виртуализация списков** для больших результатов поиска
- **Кэширование** часто используемых данных

---

## Метрики успеха сценария

### Конверсионные метрики
- **Search Initiation Rate** — процент пользователей, начинающих поиск
- **Search Completion Rate** — процент завершенных поисковых сессий
- **Click-through Rate** — клики по результатам поиска
- **Organization View Rate** — переходы в карточки организаций

### UX метрики
- **Time to First Search** — время до первого поискового запроса
- **Search Session Duration** — длительность поисковой сессии  
- **Bottomsheet Interaction Rate** — частота изменения высоты шторки
- **Filter Usage Rate** — использование фильтров поиска

### Технические метрики  
- **Search Response Time** — скорость отображения результатов
- **Map Synchronization Latency** — задержка синхронизации карты и шторки
- **Bottomsheet Animation Performance** — плавность анимаций шторки

---

## Заключение

Продуктовая структура пользовательского сценария "Поиск и навигация" основана на **единой архитектуре адаптивной шторки поверх интерактивной карты**. Это обеспечивает:

1. **Непрерывный пользовательский опыт** — все этапы поиска происходят в единой среде
2. **Контекстуальную интеграцию** — карта всегда доступна и синхронизирована с контентом
3. **Гибкое управление интерфейсом** — пользователь контролирует баланс карты и содержимого
4. **Эффективное использование пространства** — адаптивная высота шторки под разные задачи

Структура готова для разработки с использованием современных паттернов мобильного UX и производительной фронтенд-архитектуры. 