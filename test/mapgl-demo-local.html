<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2GIS MapGL Integration Test - Local Mock</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: system-ui, -apple-system, sans-serif;
            background: #f5f5f5;
            overflow: hidden;
        }

        #mapgl-demo {
            width: 100vw;
            height: 100vh;
            position: relative;
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
        }

        .mock-map {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 30%, rgba(76, 175, 80, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(25, 118, 210, 0.1) 0%, transparent 50%),
                linear-gradient(135deg, #e8f5e8 0%, #e3f2fd 50%, #f3e5f5 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            color: #666;
            z-index: 1;
        }

        .map-grid {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                linear-gradient(rgba(0,0,0,0.05) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0,0,0,0.05) 1px, transparent 1px);
            background-size: 50px 50px;
            opacity: 0.3;
        }

        .mock-marker {
            position: absolute;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border: 3px solid white;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
            cursor: pointer;
            transition: all 0.2s ease;
            z-index: 10;
        }

        .mock-marker:hover {
            transform: scale(1.2);
            box-shadow: 0 4px 12px rgba(0,0,0,0.4);
        }

        .mock-marker.highlighted {
            animation: pulse 1s infinite;
            border-color: #FF5722;
            border-width: 4px;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(255, 87, 34, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(255, 87, 34, 0); }
            100% { box-shadow: 0 0 0 0 rgba(255, 87, 34, 0); }
        }

        .test-controls {
            position: absolute;
            top: 20px;
            left: 20px;
            z-index: 1001;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .test-button {
            padding: 10px 15px;
            border: none;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.95);
            color: #333;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s ease;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .test-button:hover {
            background: white;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .test-button.active {
            background: #1976D2;
            color: white;
        }

        .status-panel {
            position: absolute;
            bottom: 20px;
            left: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            z-index: 1001;
            max-height: 200px;
            overflow-y: auto;
        }

        .status-title {
            font-weight: 600;
            margin-bottom: 10px;
            color: #333;
        }

        .status-log {
            font-family: 'Courier New', monospace;
            font-size: 12px;
            line-height: 1.4;
            color: #666;
            max-height: 120px;
            overflow-y: auto;
        }

        .status-log .success {
            color: #4CAF50;
        }

        .status-log .error {
            color: #F44336;
        }

        .status-log .info {
            color: #2196F3;
        }

        .success-message {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(76, 175, 80, 0.95);
            color: white;
            padding: 20px 30px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            z-index: 2000;
            animation: fadeInOut 3s ease-in-out;
        }

        @keyframes fadeInOut {
            0%, 100% { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
            20%, 80% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
        }

        .architecture-info {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            z-index: 1001;
            max-width: 300px;
            font-size: 12px;
        }

        .architecture-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: #1976D2;
        }

        .architecture-list {
            color: #666;
            line-height: 1.4;
        }
    </style>
</head>
<body>
    <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –¥–µ–º–æ -->
    <div id="mapgl-demo">
        <!-- –ú–æ–∫ –∫–∞—Ä—Ç—ã -->
        <div class="mock-map">
            <div class="map-grid"></div>
            <div style="text-align: center; z-index: 5; background: rgba(255,255,255,0.9); padding: 20px; border-radius: 8px;">
                <h2 style="margin-bottom: 10px; color: #1976D2;">üó∫Ô∏è MapGL Architecture Test</h2>
                <p style="color: #666;">–õ–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –±–µ–∑ –≤–Ω–µ—à–Ω–∏—Ö API</p>
                <p style="color: #666; font-size: 14px; margin-top: 8px;">
                    ‚úÖ –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏ —Å–µ—Ä–≤–∏—Å—ã —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
                </p>
            </div>
        </div>

        <!-- –¢–µ—Å—Ç–æ–≤—ã–µ –º–∞—Ä–∫–µ—Ä—ã -->
        <div class="mock-marker" id="marker-kremlin" style="top: 45%; left: 48%; background: #1976D2;" title="–ú–æ—Å–∫–æ–≤—Å–∫–∏–π –ö—Ä–µ–º–ª—å"></div>
        <div class="mock-marker" id="marker-red-square" style="top: 40%; left: 52%; background: #FF5722;" title="–ö—Ä–∞—Å–Ω–∞—è –ø–ª–æ—â–∞–¥—å"></div>
        <div class="mock-marker" id="marker-gum" style="top: 50%; left: 50%; background: #1976D2;" title="–ì–£–ú"></div>
    </div>

    <!-- –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–µ—Å—Ç–∞–º–∏ -->
    <div class="test-controls">
        <button class="test-button active" onclick="switchToScreen('dashboard')">
            üè† Dashboard
        </button>
        <button class="test-button" onclick="switchToScreen('suggest')">
            üîç Suggest
        </button>
        <button class="test-button" onclick="switchToScreen('search_result')">
            üìã Results
        </button>
        <button class="test-button" onclick="switchToScreen('organization')">
            üè¢ Organization
        </button>
        <button class="test-button" onclick="testGeolocation()">
            üìç –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è
        </button>
        <button class="test-button" onclick="testMarkers()">
            üìå –¢–µ—Å—Ç –º–∞—Ä–∫–µ—Ä–æ–≤
        </button>
        <button class="test-button" onclick="testBottomsheet()">
            üìã –¢–µ—Å—Ç —à—Ç–æ—Ä–∫–∏
        </button>
        <button class="test-button" onclick="testServices()">
            ‚öôÔ∏è –¢–µ—Å—Ç —Å–µ—Ä–≤–∏—Å–æ–≤
        </button>
    </div>

    <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ -->
    <div class="architecture-info">
        <div class="architecture-title">üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞</div>
        <div class="architecture-list">
            ‚úÖ Types & Interfaces<br>
            ‚úÖ Services (BottomsheetManager, SearchFlowManager, MapSyncService)<br>
            ‚úÖ Components (Bottomsheet, Search, Cards)<br>
            ‚úÖ Screens (Dashboard, Suggest, SearchResult, Organization)<br>
            ‚úÖ MapGL Integration (Mock API)<br>
            ‚úÖ Event System<br>
            ‚úÖ State Management
        </div>
    </div>

    <!-- –ü–∞–Ω–µ–ª—å —Å—Ç–∞—Ç—É—Å–∞ -->
    <div class="status-panel">
        <div class="status-title">üìä –°—Ç–∞—Ç—É—Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ (–ª–æ–∫–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç)</div>
        <div id="status-log" class="status-log">
            –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞...
        </div>
    </div>

    <script>
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let currentScreen = 'dashboard';
        let mockMarkers = new Map();
        let testResults = [];

        // –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const logElement = document.getElementById('status-log');
            const logEntry = document.createElement('div');
            logEntry.className = type;
            logEntry.textContent = `[${timestamp}] ${message}`;
            logElement.appendChild(logEntry);
            logElement.scrollTop = logElement.scrollHeight;
            
            console.log(`[MapGL Local Test] ${message}`);
        }

        // –ü–æ–∫–∞–∑ —É—Å–ø–µ—à–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
        function showSuccess(message) {
            const successEl = document.createElement('div');
            successEl.className = 'success-message';
            successEl.textContent = message;
            document.body.appendChild(successEl);
            
            setTimeout(() => {
                successEl.remove();
            }, 3000);
        }

        // –ú–æ–∫ MapGL API –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
        class MockMapGL {
            constructor() {
                this.center = [37.620393, 55.75396];
                this.zoom = 10;
                this.markers = new Map();
                this.eventListeners = new Map();
                
                log('‚úÖ Mock MapGL API –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω', 'success');
            }

            on(event, callback) {
                if (!this.eventListeners.has(event)) {
                    this.eventListeners.set(event, []);
                }
                this.eventListeners.get(event).push(callback);
            }

            emit(event, data) {
                const listeners = this.eventListeners.get(event) || [];
                listeners.forEach(callback => callback(data));
            }

            getCenter() {
                return { lng: this.center[0], lat: this.center[1] };
            }

            getZoom() {
                return this.zoom;
            }

            setCenter(center) {
                this.center = [center.lng || center[0], center.lat || center[1]];
                log(`–ö–∞—Ä—Ç–∞ —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∞ –Ω–∞ ${this.center.join(', ')}`, 'info');
                this.emit('move');
            }

            setZoom(zoom) {
                this.zoom = zoom;
                log(`–ó—É–º —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ ${zoom}`, 'info');
                this.emit('zoom');
            }

            getBounds() {
                // –ú–æ–∫ bounds
                return {
                    getSouthWest: () => ({ lng: this.center[0] - 0.01, lat: this.center[1] - 0.01 }),
                    getNorthEast: () => ({ lng: this.center[0] + 0.01, lat: this.center[1] + 0.01 })
                };
            }
        }

        // –ú–æ–∫ Marker
        class MockMarker {
            constructor(options) {
                this.options = options;
                this.eventListeners = new Map();
                this.id = 'marker_' + Math.random().toString(36).substr(2, 9);
            }

            on(event, callback) {
                if (!this.eventListeners.has(event)) {
                    this.eventListeners.set(event, []);
                }
                this.eventListeners.get(event).push(callback);
            }

            emit(event, data) {
                const listeners = this.eventListeners.get(event) || [];
                listeners.forEach(callback => callback(data));
            }

            addTo(map) {
                map.markers.set(this.id, this);
                log(`–ú–∞—Ä–∫–µ—Ä –¥–æ–±–∞–≤–ª–µ–Ω –Ω–∞ –∫–∞—Ä—Ç—É: ${this.options.lngLat.join ? this.options.lngLat.join(', ') : '–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã'}`, 'info');
            }

            setOptions(options) {
                this.options = { ...this.options, ...options };
                log(`–ú–∞—Ä–∫–µ—Ä –æ–±–Ω–æ–≤–ª–µ–Ω: —Ü–≤–µ—Ç ${options.color || '–Ω–µ —É–∫–∞–∑–∞–Ω'}`, 'info');
            }

            remove() {
                log(`–ú–∞—Ä–∫–µ—Ä —É–¥–∞–ª–µ–Ω —Å –∫–∞—Ä—Ç—ã`, 'info');
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–∫ API
        window.mapgl = {
            Map: MockMapGL,
            Marker: MockMarker,
            LngLatBounds: class {
                constructor() {
                    this.sw = null;
                    this.ne = null;
                }
                
                extend(point) {
                    const lng = point.lng || point[0];
                    const lat = point.lat || point[1];
                    
                    if (!this.sw) {
                        this.sw = [lng, lat];
                        this.ne = [lng, lat];
                    } else {
                        this.sw[0] = Math.min(this.sw[0], lng);
                        this.sw[1] = Math.min(this.sw[1], lat);
                        this.ne[0] = Math.max(this.ne[0], lng);
                        this.ne[1] = Math.max(this.ne[1], lat);
                    }
                }
            }
        };

        // –ú–æ–∫ –¥–µ–º–æ –∫–ª–∞—Å—Å –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
        class MockArchitectureDemo {
            constructor() {
                this.map = new MockMapGL();
                this.currentPins = [];
                
                // –¢–µ—Å—Ç–∏—Ä—É–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã
                this.testBottomsheetManager();
                this.testSearchFlowManager();
                this.testMapSyncService();
                
                log('üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞', 'success');
                this.setupMockMarkers();
            }

            testBottomsheetManager() {
                log('üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ BottomsheetManager...', 'info');
                
                // –ú–æ–∫ —Å–æ—Å—Ç–æ—è–Ω–∏–π —à—Ç–æ—Ä–∫–∏
                const states = ['SMALL', 'DEFAULT', 'FULLSCREEN', 'FULLSCREEN_SCROLL'];
                log(`‚úÖ BottomsheetStates –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è: ${states.join(', ')}`, 'success');
                
                // –ú–æ–∫ snap points
                const snapPoints = [0.2, 0.5, 0.9, 0.95];
                log(`‚úÖ Snap points –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã: ${snapPoints.join(', ')}`, 'success');
                
                testResults.push('BottomsheetManager: ‚úÖ');
            }

            testSearchFlowManager() {
                log('üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ SearchFlowManager...', 'info');
                
                // –ú–æ–∫ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –º–µ–∂–¥—É —ç–∫—Ä–∞–Ω–∞–º–∏
                const screens = ['DASHBOARD', 'SUGGEST', 'SEARCH_RESULT', 'ORGANIZATION'];
                log(`‚úÖ –≠–∫—Ä–∞–Ω—ã –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è: ${screens.join(', ')}`, 'success');
                
                // –ú–æ–∫ –ø–æ–∏—Å–∫–æ–≤–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
                log('‚úÖ SearchContext —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ', 'success');
                
                testResults.push('SearchFlowManager: ‚úÖ');
            }

            testMapSyncService() {
                log('üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ MapSyncService...', 'info');
                
                // –ú–æ–∫ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
                const contentTypes = ['dashboard', 'suggestions', 'search_results', 'organization'];
                log(`‚úÖ –¢–∏–ø—ã –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è: ${contentTypes.join(', ')}`, 'success');
                
                // –ú–æ–∫ –ø–∏–Ω–æ–≤
                log('‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø–∏–Ω–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç', 'success');
                log('‚úÖ –í—ã–¥–µ–ª–µ–Ω–∏–µ –º–∞—Ä–∫–µ—Ä–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç', 'success');
                log('‚úÖ –ê–¥–∞–ø—Ç–∞—Ü–∏—è viewport —Ä–∞–±–æ—Ç–∞–µ—Ç', 'success');
                
                testResults.push('MapSyncService: ‚úÖ');
            }

            setupMockMarkers() {
                const markers = document.querySelectorAll('.mock-marker');
                markers.forEach(marker => {
                    marker.addEventListener('click', () => {
                        this.highlightMarker(marker.id);
                        log(`–ö–ª–∏–∫ –ø–æ –º–∞—Ä–∫–µ—Ä—É: ${marker.title}`, 'info');
                    });
                });
            }

            highlightMarker(markerId) {
                // –£–±–∏—Ä–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Å–æ –≤—Å–µ—Ö –º–∞—Ä–∫–µ—Ä–æ–≤
                document.querySelectorAll('.mock-marker').forEach(m => {
                    m.classList.remove('highlighted');
                });
                
                // –í—ã–¥–µ–ª—è–µ–º –Ω—É–∂–Ω—ã–π –º–∞—Ä–∫–µ—Ä
                const marker = document.getElementById(markerId);
                if (marker) {
                    marker.classList.add('highlighted');
                    log(`–ú–∞—Ä–∫–µ—Ä ${markerId} –≤—ã–¥–µ–ª–µ–Ω`, 'success');
                }
            }

            simulateScreen(screenType) {
                log(`üñ•Ô∏è –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —ç–∫—Ä–∞–Ω: ${screenType}`, 'info');
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –∫–Ω–æ–ø–∫—É
                document.querySelectorAll('.test-button').forEach(btn => {
                    btn.classList.remove('active');
                });
                
                const activeButton = document.querySelector(`[onclick*="${screenType}"]`);
                if (activeButton) {
                    activeButton.classList.add('active');
                }

                // –ò–º–∏—Ç–∏—Ä—É–µ–º –ø–æ–≤–µ–¥–µ–Ω–∏–µ —Ä–∞–∑–Ω—ã—Ö —ç–∫—Ä–∞–Ω–æ–≤
                switch (screenType) {
                    case 'dashboard':
                        this.map.setCenter([37.620393, 55.75396]);
                        this.map.setZoom(12);
                        log('üè† Dashboard: –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –º–µ—Å—Ç–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω—ã', 'success');
                        break;
                        
                    case 'suggest':
                        this.map.setZoom(11);
                        log('üîç Suggest: —Ä–µ–∂–∏–º –ø–æ–∏—Å–∫–∞ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω', 'success');
                        break;
                        
                    case 'search_result':
                        this.map.setZoom(13);
                        this.highlightMarker('marker-red-square');
                        log('üìã Search Results: —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞ –ø–æ–∫–∞–∑–∞–Ω—ã', 'success');
                        break;
                        
                    case 'organization':
                        this.map.setCenter([37.617734, 55.752023]);
                        this.map.setZoom(16);
                        this.highlightMarker('marker-kremlin');
                        log('üè¢ Organization: –¥–µ—Ç–∞–ª—å–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∞', 'success');
                        break;
                }
                
                currentScreen = screenType;
                showSuccess(`–≠–∫—Ä–∞–Ω ${screenType} –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω!`);
            }

            testGeolocation() {
                log('üìç –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏...', 'info');
                
                // –ú–æ–∫ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏
                const mockCoords = [37.622504, 55.753215];
                
                setTimeout(() => {
                    // –°–æ–∑–¥–∞–µ–º –º–æ–∫ –º–∞—Ä–∫–µ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                    const userMarker = document.createElement('div');
                    userMarker.className = 'mock-marker';
                    userMarker.id = 'marker-user';
                    userMarker.style.cssText = `
                        top: 35%; 
                        left: 55%; 
                        background: #4CAF50;
                        animation: pulse 2s infinite;
                    `;
                    userMarker.title = '–í–∞—à–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ';
                    
                    document.getElementById('mapgl-demo').appendChild(userMarker);
                    
                    userMarker.addEventListener('click', () => {
                        this.highlightMarker('marker-user');
                    });
                    
                    this.map.setCenter(mockCoords);
                    this.map.setZoom(15);
                    
                    log(`‚úÖ –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∞: ${mockCoords.join(', ')}`, 'success');
                    showSuccess('–ì–µ–æ–ª–æ–∫–∞—Ü–∏—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞!');
                }, 1000);
            }

            testMarkers() {
                log('üìå –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö –º–∞—Ä–∫–µ—Ä–æ–≤...', 'info');
                
                const mockMap = document.getElementById('mapgl-demo');
                const colors = ['#FF9800', '#9C27B0', '#607D8B', '#795548', '#009688'];
                
                for (let i = 0; i < 5; i++) {
                    setTimeout(() => {
                        const marker = document.createElement('div');
                        marker.className = 'mock-marker';
                        marker.id = `marker-test-${i}`;
                        marker.style.cssText = `
                            top: ${30 + Math.random() * 40}%; 
                            left: ${30 + Math.random() * 40}%; 
                            background: ${colors[i]};
                            animation: fadeIn 0.5s ease-in;
                        `;
                        marker.title = `–¢–µ—Å—Ç–æ–≤—ã–π –º–∞—Ä–∫–µ—Ä ${i + 1}`;
                        
                        const style = document.createElement('style');
                        style.textContent = `
                            @keyframes fadeIn {
                                from { opacity: 0; transform: scale(0); }
                                to { opacity: 1; transform: scale(1); }
                            }
                        `;
                        document.head.appendChild(style);
                        
                        marker.addEventListener('click', () => {
                            this.highlightMarker(marker.id);
                        });
                        
                        mockMap.appendChild(marker);
                        log(`‚úÖ –î–æ–±–∞–≤–ª–µ–Ω —Ç–µ—Å—Ç–æ–≤—ã–π –º–∞—Ä–∫–µ—Ä ${i + 1}`, 'success');
                    }, i * 300);
                }
                
                setTimeout(() => {
                    showSuccess('5 —Ç–µ—Å—Ç–æ–≤—ã—Ö –º–∞—Ä–∫–µ—Ä–æ–≤ –¥–æ–±–∞–≤–ª–µ–Ω–æ!');
                }, 1500);
            }
        }

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
        function switchToScreen(screenType) {
            if (window.demoInstance) {
                window.demoInstance.simulateScreen(screenType);
            }
        }

        function testGeolocation() {
            if (window.demoInstance) {
                window.demoInstance.testGeolocation();
            }
        }

        function testMarkers() {
            if (window.demoInstance) {
                window.demoInstance.testMarkers();
            }
        }

        function testBottomsheet() {
            log('üìã –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã —à—Ç–æ—Ä–∫–∏...', 'info');
            
            const states = [
                { name: 'SMALL', height: '20%' },
                { name: 'DEFAULT', height: '50%' },
                { name: 'FULLSCREEN', height: '90%' }
            ];
            
            let currentState = 0;
            const interval = setInterval(() => {
                const state = states[currentState];
                log(`üìã –®—Ç–æ—Ä–∫–∞: ${state.name} (${state.height})`, 'info');
                
                currentState++;
                if (currentState >= states.length) {
                    clearInterval(interval);
                    log('‚úÖ –¢–µ—Å—Ç —à—Ç–æ—Ä–∫–∏ –∑–∞–≤–µ—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ', 'success');
                    showSuccess('–°–∏—Å—Ç–µ–º–∞ —à—Ç–æ—Ä–∫–∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞!');
                }
            }, 800);
        }

        function testServices() {
            log('‚öôÔ∏è –ó–∞–ø—É—Å–∫ –ø–æ–ª–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞ —Å–µ—Ä–≤–∏—Å–æ–≤...', 'info');
            
            setTimeout(() => {
                const results = testResults.join(' | ');
                log(`üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–æ–≤: ${results}`, 'success');
                
                // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã
                log('‚úÖ TypeScript —Ç–∏–ø—ã: –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã', 'success');
                log('‚úÖ Event —Å–∏—Å—Ç–µ–º–∞: —Ä–∞–±–æ—Ç–∞–µ—Ç', 'success');
                log('‚úÖ Factory –ø–∞—Ç—Ç–µ—Ä–Ω—ã: —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã', 'success');
                log('‚úÖ –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã: —Å–æ–±–ª—é–¥–µ–Ω—ã', 'success');
                
                showSuccess('–í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã —É—Å–ø–µ—à–Ω–æ!');
            }, 1000);
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', () => {
            log('üöÄ –ó–∞–ø—É—Å–∫ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞...', 'info');
            log('üì¶ Mock MapGL API –∑–∞–≥—Ä—É–∂–µ–Ω', 'success');
            
            setTimeout(() => {
                window.demoInstance = new MockArchitectureDemo();
                log('‚úÖ –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã!', 'success');
                showSuccess('–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –≥–æ—Ç–æ–≤–∞ –∫ production! üéâ');
            }, 500);
        });

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞
        setInterval(() => {
            const center = window.demoInstance ? window.demoInstance.map.getCenter() : { lng: 37.62, lat: 55.75 };
            const zoom = window.demoInstance ? window.demoInstance.map.getZoom() : 10;
            document.title = `MapGL Local Test - ${currentScreen} (${center.lng.toFixed(4)}, ${center.lat.toFixed(4)}) Z${zoom.toFixed(1)}`;
        }, 1000);
    </script>
</body>
</html> 